<!DOCTYPE html>
<html>
<head>
    <link rel="preconnect" href="https://unpkg.com">
    <script src="https://telegram.org/js/telegram-web-app.js?59"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <link rel="stylesheet" href="style.css">
    <title>ğŸ“Ÿ Mobila</title>
</head>
<body>
    <div class="container">
        <div class="split-button-group">
            <div class="split-btn">
                <button id="dataOfferAction" class="action-btn">1. Create Data Link</button>
                <button id="dataOfferCopy" class="copy-btn" disabled><span class="emoji">ğŸŒ</span></button>
            </div>
            <div class="split-btn">
                <button id="dataAnswerAction" class="action-btn">Accept Data Link</button>
                <button id="dataAnswerCopy" class="copy-btn" disabled><span class="emoji">ğŸŒ</span></button>
            </div>
        </div>
        <div class="input-group">
            <input id="pasteData" placeholder="Paste peer's offer/answer here..." />
            <button id="useDataBtn">3. Use Data <span class="emoji">ğŸŒ</span></button>
        </div>
        <div class="split-button-group" id="videoControls" style="display:none;">
            <button id="videoOfferAction" class="action-btn">ğŸ“¹ Start Video Call</button>
        </div>
        
        <div id="status" class="status">Ready to create an offer</div>
        
        <video id="localVideo" 
            autoplay 
            muted 
            playsinline 
            webkit-playsinline
            style="width:100%; max-height:200px; object-fit:cover; background:#333;">
        </video>
        <video id="remoteVideo" 
            autoplay 
            playsinline 
            webkit-playsinline
            style="width:100%; max-height:200px; object-fit:cover; background:#333;">
        </video>
        
        <button id="iceDebugBtn" class="debug-btn" onclick="testICE()">test ICE</button>
        <button id="iceServersBtn" class="debug-btn" onclick="testCircuitRelays()">test libp2p</button>
        <button id="debugBtn" class="debug-btn">ğŸ” Debug Log</button>
        <div id="debugLog" class="debug-log"></div>
        <button onclick="resetConnection()" class="debug-btn">ğŸ”„ Reset All</button>
    </div>

    <script type="importmap">
    {
        "imports": {
            "pako": "https://unpkg.com/pako@2.1.0/dist/pako.min.js",
            "libp2p": "https://unpkg.com/libp2p@3.1.2/dist/index.min.js",
            "@libp2p/circuit-relay-v2": "https://unpkg.com/@libp2p/circuit-relay-v2@4.1.2/dist/index.min.js",
            "libp2p-noise": "https://unpkg.com/@chainsafe/libp2p-noise@17.0.0/dist/index.min.js",
            "libp2p-yamux": "https://unpkg.com/@chainsafe/libp2p-yamux@8.0.1/dist/index.min.js"
        }
    }
    </script>

    <script type="module">
    import './ui.js';
    import './business.js';
    </script>
</body>
</html>
